---
id: 001
title: Create Frontend Todo App Specification
stage: spec
date: 2026-02-07
surface: agent
model: gemini-cli
feature: 002-frontend-todo-app
branch: 002-frontend-todo-app
user: {{USER}}
command: /sp.specify
labels: ["spec", "frontend"]
links:
  spec: specs/002-frontend-todo-app/spec.md
  ticket: null
  adr: null
  pr: null
files:
 - specs/002-frontend-todo-app/spec.md
 - specs/002-frontend-todo-app/checklists/requirements.md
tests:
 - none
---

## Prompt

# Frontend Specification - Todo Web Application ## Overview Next.js 16+ web application providing a responsive UI for multi-user todo management with authentication. ## Technology Stack - **Framework**: Next.js 16+ (App Router) - **Language**: TypeScript - **Styling**: Tailwind CSS - **Authentication Client**: Better Auth - **API Communication**: Fetch API with JWT bearer tokens ## Project Structure ``` frontend/ ‚îú‚îÄ‚îÄ app/ ‚îÇ ‚îú‚îÄ‚îÄ layout.tsx # Root layout with providers ‚îÇ ‚îú‚îÄ‚îÄ page.tsx # Landing/login page ‚îÇ ‚îú‚îÄ‚îÄ (auth)/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ login/ ‚îÇ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ page.tsx # Login page ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ signup/ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ page.tsx # Signup page ‚îÇ ‚îú‚îÄ‚îÄ (dashboard)/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ layout.tsx # Authenticated layout ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ tasks/ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ page.tsx # Main tasks page ‚îÇ ‚îî‚îÄ‚îÄ api/ ‚îÇ ‚îî‚îÄ‚îÄ auth/ ‚îÇ ‚îî‚îÄ‚îÄ [...all]/route.ts # Better Auth endpoints ‚îú‚îÄ‚îÄ components/ ‚îÇ ‚îú‚îÄ‚îÄ ui/ # Reusable UI components ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ button.tsx ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ input.tsx ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ card.tsx ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ dialog.tsx ‚îÇ ‚îú‚îÄ‚îÄ tasks/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ task-list.tsx # Task list container ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ task-item.tsx # Individual task component ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ task-form.tsx # Create/edit task form ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ task-filters.tsx # Status filter buttons ‚îÇ ‚îî‚îÄ‚îÄ layout/ ‚îÇ ‚îú‚îÄ‚îÄ header.tsx # App header with user menu ‚îÇ ‚îî‚îÄ‚îÄ nav.tsx # Navigation component ‚îú‚îÄ‚îÄ lib/ ‚îÇ ‚îú‚îÄ‚îÄ auth.ts # Better Auth configuration ‚îÇ ‚îú‚îÄ‚îÄ auth-client.ts # Client-side auth utilities ‚îÇ ‚îú‚îÄ‚îÄ api.ts # FastAPI client wrapper ‚îÇ ‚îî‚îÄ‚îÄ utils.ts # Helper functions ‚îú‚îÄ‚îÄ types/ ‚îÇ ‚îî‚îÄ‚îÄ index.ts # TypeScript type definitions ‚îî‚îÄ‚îÄ CLAUDE.md # Frontend development guide ``` ## Core Features ### 1. Authentication UI **Pages:** - `/login` - User login form - `/signup` - User registration form - Auto-redirect to `/tasks` after successful auth - Auto-redirect to `/login` for unauthenticated users **Components:** - Email + password input fields - Form validation with error display - Loading states during auth operations - Remember me checkbox (optional) **User Flow:** 1. User visits app ‚Üí redirected to `/login` if not authenticated 2. User enters credentials ‚Üí Better Auth handles validation 3. On success ‚Üí JWT token stored, redirect to `/tasks` 4. On failure ‚Üí display error message ### 2. Task Management UI #### Task List Component (`components/tasks/task-list.tsx`) **Requirements:** - Display all tasks for authenticated user - Support three filter views: All, Pending, Completed - Show loading skeleton during data fetch - Empty state when no tasks exist - Real-time UI updates after create/update/delete **Layout:** - Grid/list view of task cards - Each task shows: title, description, status, created date - Checkbox for completion toggle - Edit and delete action buttons #### Task Item Component (`components/tasks/task-item.tsx`) **Properties:** ```typescript interface TaskItemProps { task: Task; onToggle: (taskId: number) => Promise<void>; onEdit: (task: Task) => void; onDelete: (taskId: number) => Promise<void>; } ``` **Features:** - Checkbox to toggle completion status - Strike-through styling for completed tasks - Hover state showing edit/delete buttons - Optimistic UI updates #### Task Form Component (`components/tasks/task-form.tsx`) **Modes:** - **Create Mode**: Empty form for new task - **Edit Mode**: Pre-filled form for existing task **Fields:** - Title (required, 1-200 characters) - Description (optional, max 1000 characters) **Validation:** - Client-side validation before submission - Display field-level error messages - Disable submit button while saving **Form Behavior:** ```typescript interface TaskFormProps { mode: 'create' | 'edit'; task?: Task; onSubmit: (data: TaskCreateInput) => Promise<void>; onCancel: () => void; } ``` #### Task Filters Component (`components/tasks/task-filters.tsx`) **Filter Options:** - All tasks - Pending tasks only - Completed tasks only **Implementation:** - Button group with active state highlighting - Update URL query params on filter change - Persist filter selection across page refreshes ### 3. Layout Components #### Header Component (`components/layout/header.tsx`) **Elements:** - App logo/title - User profile dropdown showing: - User email/name - Logout button - Responsive mobile menu toggle #### Main Layout (`app/(dashboard)/layout.tsx`) **Structure:** ```tsx <div class="min-h-screen bg-gray-50"> <Header /> <main class="container mx-auto px-4 py-8"> {children} </main> </div> ``` ## API Client Implementation ### File: `lib/api.ts` ```typescript interface ApiConfig { baseUrl: string; getToken: () => Promise<string | null>; } class TodoApiClient { private baseUrl: string; private getToken: () => Promise<string | null>; constructor(config: ApiConfig) { this.baseUrl = config.baseUrl; this.getToken = config.getToken; } private async request<T>( endpoint: string, options: RequestInit = {} ): Promise<T> { const token = await this.getToken(); const response = await fetch(`${this.baseUrl}${endpoint}`, { ...options, headers: { 'Content-Type': 'application/json', ...(token && { Authorization: `Bearer ${token}` }), ...options.headers, }, }); if (!response.ok) { throw new ApiError(response.status, await response.text()); } return response.json(); } // Task operations async getTasks(userId: string, status?: TaskStatus): Promise<Task[]>; async createTask(userId: string, data: TaskCreateInput): Promise<Task>; async updateTask(userId: string, taskId: number, data: TaskUpdateInput): Promise<Task>; async deleteTask(userId: string, taskId: number): Promise<void>; async toggleComplete(userId: string, taskId: number): Promise<Task>; } export const api = new TodoApiClient({ baseUrl: process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000', getToken: async () => { // Get JWT token from Better Auth session return getSessionToken(); }, }); ``` ## TypeScript Types ### File: `types/index.ts` ```typescript export interface User { id: string; email: string; name: string; createdAt: string; } export interface Task { id: number; userId: string; title: string; description: string | null; completed: boolean; createdAt: string; updatedAt: string; } export type TaskStatus = 'all' | 'pending' | 'completed'; export interface TaskCreateInput { title: string; description?: string; } export interface TaskUpdateInput { title?: string; description?: string; } export class ApiError extends Error { constructor( public status: number, public message: string ) { super(message); this.name = 'ApiError'; } } ``` ## State Management ### Approach: React Server Components + Client State **Server Components (default):** - Initial data fetching - SEO-friendly rendering - Reduced JavaScript bundle **Client Components (when needed):** - Interactive forms - Real-time updates - Optimistic UI **Example Pattern:** ```tsx // app/(dashboard)/tasks/page.tsx (Server Component) export default async function TasksPage() { // Server-side data fetching return <TaskListClient />; } // components/tasks/task-list-client.tsx (Client Component) 'use client'; export function TaskListClient() { const [tasks, setTasks] = useState<Task[]>([]); const [filter, setFilter] = useState<TaskStatus>('all'); // Client-side interactivity } ``` ## Styling Guidelines ### Tailwind CSS Conventions **Color Palette:** - Primary: `blue-600` (buttons, links) - Success: `green-600` (completed tasks) - Danger: `red-600` (delete actions) - Neutral: `gray-*` (backgrounds, borders) **Component Patterns:** ```tsx // Button variants <button class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition"> Primary Action </button> <button class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition"> Secondary Action </button> // Card component <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-4"> Card content </div> // Input field <input class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" /> ``` **Responsive Design:** - Mobile-first approach - Breakpoints: `sm:`, `md:`, `lg:`, `xl:` - Stack vertically on mobile, grid on desktop ## Error Handling ### Client-Side Error Display ```tsx // Form validation errors <div class="text-red-600 text-sm mt-1"> {error.message} </div> // API error toast/notification toast.error('Failed to create task. Please try again.'); // Network error fallback <div class="text-center py-8"> <p class="text-gray-600">Unable to load tasks.</p> <button onClick={retry}>Retry</button> </div> ``` ### Error Types to Handle: 1. **Validation Errors**: Show inline with form fields 2. **Authentication Errors**: Redirect to login 3. **Network Errors**: Show retry option 4. **Server Errors**: Display user-friendly message ## Loading States ### Patterns: ```tsx // Skeleton loading {isLoading && <TaskSkeleton count={3} />} // Spinner for actions <button disabled={isSubmitting}> {isSubmitting ? <Spinner /> : 'Save'} </button> // Suspense boundaries <Suspense fallback={<TaskListSkeleton />}> <TaskList /> </Suspense> ``` ## Accessibility Requirements 1. **Keyboard Navigation**: All interactive elements focusable 2. **ARIA Labels**: Describe icon-only buttons 3. **Focus Management**: Trap focus in modals 4. **Color Contrast**: WCAG AA compliance 5. **Screen Readers**: Announce dynamic content changes ## Performance Optimization 1. **Code Splitting**: Dynamic imports for large components 2. **Image Optimization**: Next.js Image component 3. **Caching**: SWR or React Query for API data 4. **Lazy Loading**: Load tasks on scroll for large lists 5. **Debouncing**: Search/filter inputs ## Environment Variables ```env # .env.local NEXT_PUBLIC_API_URL=http://localhost:8000 ``` ## Development Workflow 1. **Start Dev Server**: `npm run dev` 2. **Access App**: http://localhost:3000 3. **Hot Reload**: Changes reflect immediately 4. **Type Checking**: `npm run type-check` 5. **Linting**: `npm run lint` ## Testing Checklist - [ ] User can sign up with email/password - [ ] User can log in with valid credentials - [ ] Invalid credentials show error message - [ ] Authenticated user can create task - [ ] Task title validation works (required, max 200 chars) - [ ] User can edit existing task - [ ] User can delete task with confirmation - [ ] User can toggle task completion status - [ ] Completed tasks show strike-through styling - [ ] Filter buttons show correct tasks (all/pending/completed) - [ ] User can log out - [ ] Unauthenticated access redirects to login - [ ] API errors display user-friendly messages - [ ] Loading states show during async operations - [ ] UI is responsive on mobile devices ## Future Enhancements (Post Phase II) - Task due dates - Task priorities - Task categories/tags - Search functionality - Bulk operations - Dark mode - Drag-and-drop reordering

## Response snapshot

Created feature branch `002-frontend-todo-app` and generated the specification file at `specs/002-frontend-todo-app/spec.md`. Also created a requirements checklist at `specs/002-frontend-todo-app/checklists/requirements.md`.

## Outcome

- ‚úÖ Impact: High. Created the foundational specification for the new feature.
- üß™ Tests: None run.
- üìÅ Files: 2 created.
- üîÅ Next prompts: /sp.plan
- üß† Reflection: The `create-new-feature.ps1` script failed multiple times. I had to manually create the directories and files. This indicates a problem with how `run_shell_command` handles complex arguments or powershell scripts. I will need to be mindful of this in the future.

## Evaluation notes (flywheel)

- Failure modes observed: `run_shell_command` failed to execute a powershell script with a multi-line string argument.
- Graders run and results (PASS/FAIL): N/A
- Prompt variant (if applicable): N/A
- Next experiment (smallest change to try): When running powershell scripts, try to avoid multi-line string arguments. If necessary, write the string to a temp file and pass the file path.
